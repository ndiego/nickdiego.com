---
title: Code Block Component Demo
date: 2025-01-16
excerpt: A demonstration of the custom CodeBlock component with syntax highlighting, line numbers, copy button, and theme support.
categories:
  - Tutorials
---

This post demonstrates the custom CodeBlock component with Shiki syntax highlighting, optional line numbers, a copy button, and full light/dark mode support.

## Basic JavaScript

Standard fenced code blocks automatically get syntax highlighting:

```javascript
const fs = require("fs");
const path = require("path");

// Base theme.json structure
const baseConfig = require("../src/json/base.json");

// Function to read and parse JSON file
function readJsonFile(filePath) {
  try {
    return JSON.parse(fs.readFileSync(filePath, "utf8"));
  } catch (error) {
    console.error(`Error reading ${filePath}:`, error);
    return {};
  }
}
```

## TypeScript with Types

```typescript
interface User {
  id: string;
  name: string;
  email: string;
  createdAt: Date;
}

async function fetchUser(id: string): Promise<User | null> {
  const response = await fetch(`/api/users/${id}`);

  if (!response.ok) {
    return null;
  }

  return response.json();
}
```

## React Component (TSX)

```tsx
import { useState } from "react";

interface ButtonProps {
  label: string;
  onClick?: () => void;
}

export function Button({ label, onClick }: ButtonProps) {
  const [clicked, setClicked] = useState(false);

  const handleClick = () => {
    setClicked(true);
    onClick?.();
  };

  return (
    <button
      onClick={handleClick}
      className="px-4 py-2 bg-blue-500 text-white rounded"
    >
      {clicked ? "âœ“ " : ""}
      {label}
    </button>
  );
}
```

## Without Line Numbers

Using `showLineNumbers={false}` in the code fence meta:

```bash showLineNumbers={false}
npm install next react react-dom
npm run dev
```

## With Filename Header

```json filename="package.json"
{
  "name": "my-app",
  "version": "1.0.0",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start"
  }
}
```

## Collapsible Code Block

Using `maxLines={8}` to limit the visible lines with an expand button:

```typescript filename="ListenButton.tsx" maxLines={8}
const checkResponse = await fetch(`/api/generate-audio?slug=${slug}`);
const checkData = await checkResponse.json();

if (checkData.exists && checkData.url) {
  setAudioUrl(checkData.url);
  return;
}

// Generate if it doesn't exist yet
setAudioStats("generating");

const response = await fetch("/api/generate-audio", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ slug }),
});

const data = await response.json();
if (data.url) {
  setAudioUrl(data.url);
  setAudioStats("ready");
}
```

```typescript maxLines={8}
const checkResponse = await fetch(`/api/generate-audio?slug=${slug}`);
const checkData = await checkResponse.json();

if (checkData.exists && checkData.url) {
  setAudioUrl(checkData.url);
  return;
}

// Generate if it doesn't exist yet
setAudioStats("generating");

const response = await fetch("/api/generate-audio", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ slug }),
});

const data = await response.json();
if (data.url) {
  setAudioUrl(data.url);
  setAudioStats("ready");
}
```

## PHP Example

```php
<?php
function get_block_wrapper_attributes($attributes = []) {
    $wrapper_attributes = [];

    if (!empty($attributes['className'])) {
        $wrapper_attributes['class'] = $attributes['className'];
    }

    return implode(' ', array_map(
        fn($key, $value) => sprintf('%s="%s"', $key, esc_attr($value)),
        array_keys($wrapper_attributes),
        $wrapper_attributes
    ));
}
```

## CSS

```css
.code-block {
  position: relative;
  border-radius: 0.5rem;
  overflow: hidden;
}

.code-block .shiki {
  margin: 0;
  padding: 1rem;
  background: transparent;
}

.code-block pre code {
  font-family: "Geist Mono", monospace;
  font-size: 0.875rem;
  line-height: 1.5;
}
```

## HTML

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Page</title>
  </head>
  <body>
    <main>
      <h1>Hello, World!</h1>
      <p>Welcome to my website.</p>
    </main>
  </body>
</html>
```

## Shell/Bash

```bash
#!/bin/bash

# Deploy script
echo "Starting deployment..."

# Build the project
npm run build

# Upload to server
rsync -avz --delete ./out/ user@server:/var/www/html/

echo "Deployment complete!"
```

## SQL

```sql
SELECT
  users.id,
  users.name,
  COUNT(posts.id) as post_count
FROM users
LEFT JOIN posts ON posts.author_id = users.id
WHERE users.created_at > '2024-01-01'
GROUP BY users.id, users.name
HAVING COUNT(posts.id) > 5
ORDER BY post_count DESC
LIMIT 10;
```

## Diff

```diff
- const oldFunction = () => {
-   return 'old';
- };
+ const newFunction = () => {
+   return 'new and improved';
+ };
```

## Inline Code

You can also use inline code like `const x = 42` or `npm install` within paragraphs. These are styled differently from code blocks.

---

Try toggling between light and dark mode to see the syntax highlighting adapt!
